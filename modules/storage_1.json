{
    "name": "MSTG-STORAGE - MSTG-STORAGE-1",
    "description": "The app securely stores sensitive data.",
    "data": [
        {
            "target_file": "*.java",
            "rules": [
                {
                    "description": "The Shared Preferences related instances...",
                    "keyword":  "getSharedPreferences(",
                    "args": "-n",
                    "note": "It is recommended to use shared preferences appropriately, if observed.\nPlease note that, Misuse of the SharedPreferences API can often lead to the exposure of sensitive data.\nMODE_WORLD_READABLE allows all applications to access and read the file contents.\nApplications compiled with an android:targetSdkVersion value less than 17 may be affected, if they run on an OS version that was released before Android 4.2 (API level 17).",
                    "reference": "\n  - OWASP MASVS: MSTG-STORAGE-2 | CWE-922: Insecure Storage of Sensitive Information\n  - https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements"
                },
                {
                    "description": "The SQLite Database Storage related instances...",
                    "keyword": [
                        "openOrCreateDatabase",
                        "getWritableDatabase",
                        "getReadableDatabase"
                    ],
                    "args": "-n",
                    "note": "It is recommended that sensitive data should not be stored in unencrypted SQLite databases, if observed.\nPlease note that, SQLite databases should be password-encrypted.",
                    "reference": "\n  - OWASP MASVS: MSTG-STORAGE-2 | CWE-922: Insecure Storage of Sensitive Information\n  - https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements"
                },
                {
                    "description": "The Realm Database instances...",
                    "keyword":  "RealmConfiguration",
                    "args": "-n",
                    "note": "It is recommended that Realm database instances should not be misconfigured, if observed.\nPlease note that, the database and its contents have been encrypted with a key stored in the configuration file.",
                    "reference": "\n  - OWASP MASVS: MSTG-STORAGE-2 | CWE-922: Insecure Storage of Sensitive Information\n  - https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements"
                },
                {
                    "description": "The Internal Storage related instances...",
                    "keyword": [
                        "openFileOutput",
                        "MODE_WORLD_READABLE",
                        "MODE_WORLD_WRITEABLE",
                        "FileInputStream"
                    ],
                    "args": "-n",
                    "note": "It is recommended that sensitive files saved to the internal storage should not be accessed by other application, if observed.\nPlease note that, Modes such as MODE_WORLD_READABLE and MODE_WORLD_WRITEABLE may pose a security risk.",
                    "reference": "\n  - OWASP MASVS: MSTG-STORAGE-2 | CWE-922: Insecure Storage of Sensitive Information\n  - https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements"
                },
                {
                    "description": "The External Storage related instances...",
                    "keyword": [
                        "getExternalFilesDir",
                        "getExternalFilesDirs",
                        "getExternalCacheDir",
                        "getExternalCacheDirs",
                        "getCacheDir",
                        "getExternalStorageState",
                        "getExternalStorageDirectory",
                        "getExternalStoragePublicDirectory"
                    ],
                    "args": "-n",
                    "note": "It is recommended that any sensitive data should not be stored in the external storage, if observed.\nPlease note that, Files saved to external storage are world-readable and it can be used by an attacker to allow for arbitrary control of the application in some scenarios.",
                    "reference": "\n  - OWASP MASVS: MSTG-STORAGE-2 | CWE-922: Insecure Storage of Sensitive Information\n  - https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements"
                },
                {
                    "description": "The Temporary File Creation instances...",
                    "keyword":  ".createTempFile(",
                    "args": "-n",
                    "note": "It is recommended that the temporary files should be securely deleted upon their usage, if observed...",
                    "reference": "https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements"
                },
                {
                    "description": "The Local Storage - Input Validation...",
                    "keyword":  "SharedPreferences.Editor",
                    "args": "-n",
                    "note": "It is recommended that input validation needs to be applied on the sensitive data the moment it is read back again, if observed...",
                    "reference": "https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment"
                }
            ]
        },
        {
            "target_file": "*.xml",
            "rules": [
                {
                    "description":"The Firebase Database instances...",
                    "keyword":".firebaseio.com",
                    "args":"-n",
                    "note":"It is recommended to use shared preferences appropriately, if observed.\nPlease note that, Misuse of the SharedPreferences API can often lead to the exposure of sensitive data.\nMODE_WORLD_READABLE allows all applications to access and read the file contents.\nApplications compiled with an android:targetSdkVersion value less than 17 may be affected, if they run on an OS version that was released before Android 4.2 (API level 17).",
                    "reference":"- OWASP MASVS: MSTG-STORAGE-2 | CWE-922: Insecure Storage of Sensitive Information\n- https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements"
                    
                }
            ]
        }
    ]
}